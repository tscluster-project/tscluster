

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial with Synthetic Data &mdash; tscluster  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS"}}})</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Colab Notebook" href="../../colab_notebook.html" />
    <link rel="prev" title="Tutorial with Real World Data" href="../with_real_world_data/notebook.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            tscluster
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../API.html">API Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../user_guide.html">User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../tscluster_tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../with_real_world_data/notebook.html">Tutorial with Real World Data</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Tutorial with Synthetic Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loading-data">Loading Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-conversion">Data Conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#metrics">Metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tsplot">TSPlot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#temporal-clustering-models">Temporal Clustering Models</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../colab_notebook.html">Colab Notebook</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">tscluster</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../user_guide.html">User Guide</a></li>
          <li class="breadcrumb-item"><a href="../../tscluster_tutorial.html">Tutorial</a></li>
      <li class="breadcrumb-item active">Tutorial with Synthetic Data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/source/tscluster_tutorial_files/with_synthetic_data/notebook.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial-with-synthetic-data">
<h1>Tutorial with Synthetic Data<a class="headerlink" href="#tutorial-with-synthetic-data" title="Link to this heading">ÔÉÅ</a></h1>
<p>This is an example notebook with overview of the usage of the modules in tscluster.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">tscluster</span> <span class="c1"># install tscluster</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">numpy</span><span class="o">&gt;=</span><span class="mf">1.26</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="o">-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="mf">1.26.4</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pandas</span><span class="o">&gt;=</span><span class="mf">2.2</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="o">-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">2</span><span class="p">))</span> <span class="p">(</span><span class="mf">2.2.2</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="o">-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">3</span><span class="p">))</span> <span class="p">(</span><span class="mf">3.8.4</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">python</span><span class="o">-</span><span class="n">dateutil</span><span class="o">&gt;=</span><span class="mf">2.8.2</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pandas</span><span class="o">&gt;=</span><span class="mf">2.2</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">2</span><span class="p">))</span> <span class="p">(</span><span class="mf">2.8.2</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pytz</span><span class="o">&gt;=</span><span class="mf">2020.1</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pandas</span><span class="o">&gt;=</span><span class="mf">2.2</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">2</span><span class="p">))</span> <span class="p">(</span><span class="mf">2023.4</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">tzdata</span><span class="o">&gt;=</span><span class="mf">2022.7</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pandas</span><span class="o">&gt;=</span><span class="mf">2.2</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">2</span><span class="p">))</span> <span class="p">(</span><span class="mf">2024.1</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">contourpy</span><span class="o">&gt;=</span><span class="mf">1.0.1</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">3</span><span class="p">))</span> <span class="p">(</span><span class="mf">1.2.1</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">cycler</span><span class="o">&gt;=</span><span class="mf">0.10</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">3</span><span class="p">))</span> <span class="p">(</span><span class="mf">0.12.1</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">fonttools</span><span class="o">&gt;=</span><span class="mf">4.22.0</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">3</span><span class="p">))</span> <span class="p">(</span><span class="mf">4.51.0</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">kiwisolver</span><span class="o">&gt;=</span><span class="mf">1.3.1</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">3</span><span class="p">))</span> <span class="p">(</span><span class="mf">1.4.5</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">packaging</span><span class="o">&gt;=</span><span class="mf">20.0</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">3</span><span class="p">))</span> <span class="p">(</span><span class="mf">24.0</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pillow</span><span class="o">&gt;=</span><span class="mi">8</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">3</span><span class="p">))</span> <span class="p">(</span><span class="mf">9.4.0</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pyparsing</span><span class="o">&gt;=</span><span class="mf">2.3.1</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">3</span><span class="p">))</span> <span class="p">(</span><span class="mf">3.1.2</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">six</span><span class="o">&gt;=</span><span class="mf">1.5</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">python</span><span class="o">-</span><span class="n">dateutil</span><span class="o">&gt;=</span><span class="mf">2.8.2</span><span class="o">-&gt;</span><span class="n">pandas</span><span class="o">&gt;=</span><span class="mf">2.2</span><span class="o">-&gt;-</span><span class="n">r</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">line</span> <span class="mi">2</span><span class="p">))</span> <span class="p">(</span><span class="mf">1.16.0</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">tscluster</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="mf">1.0.4</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">numpy</span><span class="o">&gt;=</span><span class="mf">1.26</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.26.4</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">scipy</span><span class="o">&gt;=</span><span class="mf">1.10</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.11.4</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">gurobipy</span><span class="o">&gt;=</span><span class="mf">11.0</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">11.0.2</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">tslearn</span><span class="o">&gt;=</span><span class="mf">0.6.3</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.6.3</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">h5py</span><span class="o">&gt;=</span><span class="mf">3.10</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.11.0</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pandas</span><span class="o">&gt;=</span><span class="mf">2.2</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.2.2</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.8.4</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">contourpy</span><span class="o">&gt;=</span><span class="mf">1.0.1</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.2.1</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">cycler</span><span class="o">&gt;=</span><span class="mf">0.10</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.12.1</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">fonttools</span><span class="o">&gt;=</span><span class="mf">4.22.0</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">4.51.0</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">kiwisolver</span><span class="o">&gt;=</span><span class="mf">1.3.1</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.4.5</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">packaging</span><span class="o">&gt;=</span><span class="mf">20.0</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">24.0</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pillow</span><span class="o">&gt;=</span><span class="mi">8</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">9.4.0</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pyparsing</span><span class="o">&gt;=</span><span class="mf">2.3.1</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.1.2</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">python</span><span class="o">-</span><span class="n">dateutil</span><span class="o">&gt;=</span><span class="mf">2.7</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">2.8.2</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">pytz</span><span class="o">&gt;=</span><span class="mf">2020.1</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pandas</span><span class="o">&gt;=</span><span class="mf">2.2</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">2023.4</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">tzdata</span><span class="o">&gt;=</span><span class="mf">2022.7</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">pandas</span><span class="o">&gt;=</span><span class="mf">2.2</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">2024.1</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">tslearn</span><span class="o">&gt;=</span><span class="mf">0.6.3</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.2.2</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">numba</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">tslearn</span><span class="o">&gt;=</span><span class="mf">0.6.3</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.58.1</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">joblib</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">tslearn</span><span class="o">&gt;=</span><span class="mf">0.6.3</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.4.2</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">six</span><span class="o">&gt;=</span><span class="mf">1.5</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">python</span><span class="o">-</span><span class="n">dateutil</span><span class="o">&gt;=</span><span class="mf">2.7</span><span class="o">-&gt;</span><span class="n">matplotlib</span><span class="o">&lt;</span><span class="mf">3.9</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.8</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">1.16.0</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">llvmlite</span><span class="o">&lt;</span><span class="mf">0.42</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">0.41.0</span><span class="n">dev0</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">numba</span><span class="o">-&gt;</span><span class="n">tslearn</span><span class="o">&gt;=</span><span class="mf">0.6.3</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">0.41.1</span><span class="p">)</span>
<span class="n">Requirement</span> <span class="n">already</span> <span class="n">satisfied</span><span class="p">:</span> <span class="n">threadpoolctl</span><span class="o">&gt;=</span><span class="mf">2.0.0</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">scikit</span><span class="o">-</span><span class="n">learn</span><span class="o">-&gt;</span><span class="n">tslearn</span><span class="o">&gt;=</span><span class="mf">0.6.3</span><span class="o">-&gt;</span><span class="n">tscluster</span><span class="p">)</span> <span class="p">(</span><span class="mf">3.5.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Importing Libraries</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># uncomment the line below if widget is enable in your environment. This is useful for making tsplot&#39;s waterfall_plot interactive</span>
<span class="c1"># %matplotlib widget</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">from</span> <span class="nn">tscluster.opttscluster</span> <span class="kn">import</span> <span class="n">OptTSCluster</span>
<span class="kn">from</span> <span class="nn">tscluster.tskmeans</span> <span class="kn">import</span> <span class="n">TSKmeans</span><span class="p">,</span> <span class="n">TSGlobalKmeans</span>
<span class="kn">from</span> <span class="nn">tscluster.preprocessing</span> <span class="kn">import</span> <span class="n">TSStandardScaler</span><span class="p">,</span> <span class="n">TSMinMaxScaler</span>
<span class="kn">from</span> <span class="nn">tscluster.preprocessing.utils</span> <span class="kn">import</span> <span class="n">load_data</span><span class="p">,</span> <span class="n">tnf_to_ntf</span><span class="p">,</span> <span class="n">ntf_to_tnf</span><span class="p">,</span> <span class="n">to_dfs</span><span class="p">,</span> <span class="n">broadcast_data</span>
<span class="kn">from</span> <span class="nn">tscluster.metrics</span> <span class="kn">import</span> <span class="n">inertia</span><span class="p">,</span> <span class="n">max_dist</span>
<span class="kn">from</span> <span class="nn">tscluster.tsplot</span> <span class="kn">import</span> <span class="n">tsplot</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">par_dir</span> <span class="o">=</span> <span class="s2">&quot;tscluster_sample_data&quot;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># download the sample data</span>

<span class="c1"># we need to store the data on the local Colab file system</span>
<span class="err">!</span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tscluster</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">tscluster</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">tscluster_sample_data</span><span class="o">.</span><span class="n">zip</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">par_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">par_dir</span><span class="p">)</span>

<span class="c1"># unzipping the downloaded file to &#39;tscluster_sample_data&#39; directory in local file system</span>
<span class="err">!</span><span class="n">unzip</span> <span class="o">-</span><span class="n">o</span> <span class="n">tscluster_sample_data</span><span class="o">.</span><span class="n">zip</span> <span class="o">-</span><span class="n">d</span> <span class="n">tscluster_sample_data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>--2024-05-22 00:02:47--  https://raw.githubusercontent.com/tscluster-project/tscluster/main/test/tscluster_sample_data.zip
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 11197 (11K) [application/zip]
Saving to: ‚Äòtscluster_sample_data.zip.2‚Äô


      tscluster   0%[                    ]       0  --.-KB/s
</pre></div>
</div>
<p>tscluster_sample_da 100%[===================&gt;]  10.93K  ‚Äì.-KB/s    in 0s</p>
<blockquote>
<div><p>2024-05-22 00:02:47 (34.9 MB/s) - ‚Äòtscluster_sample_data.zip.2‚Äô saved [11197/11197]</p>
<dl class="simple">
<dt>Archive:  tscluster_sample_data.zip</dt><dd><p>inflating: tscluster_sample_data/synthetic_csv/timestep_0.csv
inflating: tscluster_sample_data/synthetic_csv/timestep_1.csv
inflating: tscluster_sample_data/synthetic_csv/timestep_2.csv
inflating: tscluster_sample_data/synthetic_csv/timestep_3.csv
inflating: tscluster_sample_data/synthetic_csv/timestep_4.csv
inflating: tscluster_sample_data/synthetic_csv2/year-2000.csv
inflating: tscluster_sample_data/synthetic_csv2/year-2005.csv
inflating: tscluster_sample_data/synthetic_csv2/year-2010.csv
inflating: tscluster_sample_data/synthetic_csv2/year-2015.csv
inflating: tscluster_sample_data/synthetic_csv2/year-2020.csv
inflating: tscluster_sample_data/synthetic_json/timestep_0.json
inflating: tscluster_sample_data/synthetic_json/timestep_1.json
inflating: tscluster_sample_data/synthetic_json/timestep_2.json
inflating: tscluster_sample_data/synthetic_json/timestep_3.json
inflating: tscluster_sample_data/synthetic_json/timestep_4.json
inflating: tscluster_sample_data/synthetic_npy/timestep_0.npy
inflating: tscluster_sample_data/synthetic_npy/timestep_1.npy
inflating: tscluster_sample_data/synthetic_npy/timestep_2.npy
inflating: tscluster_sample_data/synthetic_npy/timestep_3.npy
inflating: tscluster_sample_data/synthetic_npy/timestep_4.npy
inflating: tscluster_sample_data/sythetic_data.npy</p>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">par_dir</span><span class="p">)</span>
</pre></div>
</div>
<section id="loading-data">
<h2>Loading Data<a class="headerlink" href="#loading-data" title="Link to this heading">ÔÉÅ</a></h2>
<section id="from-a-npy-file">
<h3>from a npy file<a class="headerlink" href="#from-a-npy-file" title="Link to this heading">ÔÉÅ</a></h3>
<p>If data is a numpy array stored as a <code class="docutils literal notranslate"><span class="pre">.npy</span></code> file, you can use the
<code class="docutils literal notranslate"><span class="pre">load_data</span></code> function to load it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">label_dict</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;./sythetic_data.npy&quot;</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">load_data</span></code> function returns a tuple, the first value of the tuple
is the loaded data (a 3-D array in ‚ÄòTNF‚Äô format), while the second value
of the tuple is the label_dict of the data. The <code class="docutils literal notranslate"><span class="pre">label_dict</span></code> is a
dictionary whose keys are ‚ÄòT‚Äô, ‚ÄòN‚Äô, and ‚ÄòF‚Äô (which are the number of
time steps, entities, and features respectively). Value of each key is a
list such that the value of key: - ‚ÄòT‚Äô is a list of names/labels of each
time step to be used as index of each dataframe. If None, range(0, T) is
used. Where T is the number of time steps in the fitted data - ‚ÄòN‚Äô
(ignored) is a list of names/labels of each entity. If None, range(0, N)
is used. Where N is the number of entities/observations in the fitted
data - ‚ÄòF‚Äô is a list of names/labels of each feature to be used as
column of each dataframe. If None, range(0, F) is used. Where F is the
number of features in the fitted data</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># checking the label_dict</span>
<span class="nb">print</span><span class="p">(</span><span class="n">label_dict</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
</pre></div>
</div>
<p>As seen in the output above, the data has 10 time steps, 15 entities and
1 feature. The data is a synthetic data created for demonstration
purposes in this notebook. The time steps could be years e.g.¬†year 2001
to 2010, the entities could be zipcodes/postal codes e.g 15 postal codes
in Toronto, and the features could be any variable(s) measured for each
entity in each time step e.g.¬†population.</p>
<p>This notebook will focus on using the common attributes and methods of
the modules available in <strong>tscluster</strong>. For an example notebook with
applications to real-life data, see <a class="reference external" href="https://colab.research.google.com/drive/1dH3sj8jybbOomuwQR9eGhNnYqyZ4OKZM?usp=sharing">this
notebook</a>.</p>
<p>Checking the first time steps of the first five entities.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[[</span><span class="mf">15.09011416</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">15.09011416</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">6.92001802</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">6.92001802</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">11.39918324</span><span class="p">]],</span>

       <span class="p">[[</span><span class="mf">10.4044138</span> <span class="p">],</span>
        <span class="p">[</span><span class="mf">10.4044138</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">8.76582237</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">8.76582237</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">11.33740921</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="mf">8.67698496</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">8.67698496</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">9.55393712</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">9.55393712</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">10.57717395</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="mf">6.01642654</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">6.01642654</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">10.63908781</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">10.63908781</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">10.6098427</span> <span class="p">]],</span>

       <span class="p">[[</span> <span class="mf">4.89052455</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">4.89052455</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">11.61399362</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">11.61399362</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">9.34167455</span><span class="p">]]])</span>
</pre></div>
</div>
</section>
<section id="from-a-list">
<h3>from a list<a class="headerlink" href="#from-a-list" title="Link to this heading">ÔÉÅ</a></h3>
<p>Data can also be loaded from a list. This can be a list of 2-D numpy
arrays, or list of pandas dataframes, or list of file paths. By default,
the list is of length <code class="docutils literal notranslate"><span class="pre">T</span></code> (number of time steps), where each element
of the list is interpreted as a data for all entities at a particular
time step. Set the <code class="docutils literal notranslate"><span class="pre">arr_format</span></code> parameter to ‚ÄòNTF‚Äô to specify that
each element of the input list is the time series data for a particular
entity for all time steps. Valid files are <code class="docutils literal notranslate"><span class="pre">.npy</span></code>, <code class="docutils literal notranslate"><span class="pre">.npz</span></code>,
<code class="docutils literal notranslate"><span class="pre">.json</span></code>, <code class="docutils literal notranslate"><span class="pre">xlsx</span></code>, <code class="docutils literal notranslate"><span class="pre">.csv</span></code> or any file readable by
<code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code> function.</p>
<p>Reading from a list of dataframes</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
    <span class="s1">&#39;f2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
                  <span class="p">)</span>
<span class="n">df1</span>
</pre></div>
</div>
  <div id="df-275ddb8e-635c-4842-a565-0db7615f9b52" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f1</th>
      <th>f2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>e1</th>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>e2</th>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>e3</th>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>e4</th>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>e5</th>
      <td>4</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-275ddb8e-635c-4842-a565-0db7615f9b52')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-275ddb8e-635c-4842-a565-0db7615f9b52 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-275ddb8e-635c-4842-a565-0db7615f9b52');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2b3298c1-e717-430d-8401-71ecdbe9d632">
  <button class="colab-df-quickchart" onclick="quickchart('df-2b3298c1-e717-430d-8401-71ecdbe9d632')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2b3298c1-e717-430d-8401-71ecdbe9d632 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_a6e57aaf-2d90-44d3-9973-0901ec5314b4">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df1')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_a6e57aaf-2d90-44d3-9973-0901ec5314b4 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df1');
      }
      })();
    </script>
  </div>

    </div>
  </div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;f2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">105</span><span class="p">,</span> <span class="mi">110</span><span class="p">),</span>
    <span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">105</span><span class="p">)</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
                  <span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
  <div id="df-322d53f2-d3b8-423a-99b4-62ab34884022" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f2</th>
      <th>f1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>e1</th>
      <td>105</td>
      <td>100</td>
    </tr>
    <tr>
      <th>e2</th>
      <td>106</td>
      <td>101</td>
    </tr>
    <tr>
      <th>e3</th>
      <td>107</td>
      <td>102</td>
    </tr>
    <tr>
      <th>e4</th>
      <td>108</td>
      <td>103</td>
    </tr>
    <tr>
      <th>e5</th>
      <td>109</td>
      <td>104</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-322d53f2-d3b8-423a-99b4-62ab34884022')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-322d53f2-d3b8-423a-99b4-62ab34884022 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-322d53f2-d3b8-423a-99b4-62ab34884022');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-962d801c-c28d-4226-ba32-c2ba12a13d2b">
  <button class="colab-df-quickchart" onclick="quickchart('df-962d801c-c28d-4226-ba32-c2ba12a13d2b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-962d801c-c28d-4226-ba32-c2ba12a13d2b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_154f197f-e426-4439-85e7-d9146c3af610">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df2')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_154f197f-e426-4439-85e7-d9146c3af610 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df2');
      }
      })();
    </script>
  </div>

    </div>
  </div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_arr</span><span class="p">,</span> <span class="n">label_dict</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shape of X_arr is </span><span class="si">{</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">X_arr</span> <span class="o">=</span> <span class="n">X_arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">X_arr</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="n">of</span> <span class="n">X_arr</span> <span class="ow">is</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[[</span>  <span class="mf">0.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">],</span>
        <span class="p">[</span>  <span class="mf">1.</span><span class="p">,</span>   <span class="mf">6.</span><span class="p">],</span>
        <span class="p">[</span>  <span class="mf">2.</span><span class="p">,</span>   <span class="mf">7.</span><span class="p">],</span>
        <span class="p">[</span>  <span class="mf">3.</span><span class="p">,</span>   <span class="mf">8.</span><span class="p">],</span>
        <span class="p">[</span>  <span class="mf">4.</span><span class="p">,</span>   <span class="mf">9.</span><span class="p">]],</span>

       <span class="p">[[</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">105.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">101.</span><span class="p">,</span> <span class="mf">106.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">102.</span><span class="p">,</span> <span class="mf">107.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">103.</span><span class="p">,</span> <span class="mf">108.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">104.</span><span class="p">,</span> <span class="mf">109.</span><span class="p">]]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">label_dict</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;e1&#39;</span><span class="p">,</span> <span class="s1">&#39;e2&#39;</span><span class="p">,</span> <span class="s1">&#39;e3&#39;</span><span class="p">,</span> <span class="s1">&#39;e4&#39;</span><span class="p">,</span> <span class="s1">&#39;e5&#39;</span><span class="p">],</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;f2&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<p>To get the output in ‚ÄòNTF‚Äô format, set the <code class="docutils literal notranslate"><span class="pre">output_arr_format</span></code>
parameter to ‚ÄòNTF‚Äô</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_arr</span><span class="p">,</span> <span class="n">label_dict</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">output_arr_format</span><span class="o">=</span><span class="s1">&#39;NTF&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shape of X_arr is </span><span class="si">{</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">X_arr</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="n">of</span> <span class="n">X_arr</span> <span class="ow">is</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[[</span>  <span class="mf">0.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">105.</span><span class="p">]],</span>

       <span class="p">[[</span>  <span class="mf">1.</span><span class="p">,</span>   <span class="mf">6.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">101.</span><span class="p">,</span> <span class="mf">106.</span><span class="p">]],</span>

       <span class="p">[[</span>  <span class="mf">2.</span><span class="p">,</span>   <span class="mf">7.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">102.</span><span class="p">,</span> <span class="mf">107.</span><span class="p">]],</span>

       <span class="p">[[</span>  <span class="mf">3.</span><span class="p">,</span>   <span class="mf">8.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">103.</span><span class="p">,</span> <span class="mf">108.</span><span class="p">]],</span>

       <span class="p">[[</span>  <span class="mf">4.</span><span class="p">,</span>   <span class="mf">9.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">104.</span><span class="p">,</span> <span class="mf">109.</span><span class="p">]]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">label_dict</span> <span class="c1"># label_dict will remain the same</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;e1&#39;</span><span class="p">,</span> <span class="s1">&#39;e2&#39;</span><span class="p">,</span> <span class="s1">&#39;e3&#39;</span><span class="p">,</span> <span class="s1">&#39;e4&#39;</span><span class="p">,</span> <span class="s1">&#39;e5&#39;</span><span class="p">],</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;f2&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<p>The same applies to list of file paths. E.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">file_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;./synthetic_csv/timestep_0.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;./synthetic_csv/timestep_1.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;./synthetic_csv/timestep_2.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;./synthetic_csv/timestep_3.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;./synthetic_csv/timestep_4.csv&quot;</span>
<span class="p">]</span>

<span class="n">X_arr</span><span class="p">,</span> <span class="n">label_dict</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shape of X_arr is </span><span class="si">{</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="n">of</span> <span class="n">X_arr</span> <span class="ow">is</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">label_dict</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
 <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
 <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
</pre></div>
</div>
<p>You can also pass arguments to the file reader used by using the
<code class="docutils literal notranslate"><span class="pre">read_file_args</span></code> parameter. This parameter accepts a dictionary where
the keys are the names of the file reader parameters (in string), and
the values are the values of the file reader parameter. E.g. if file
reader is pd.read_csv (reader for csv file), you can pass <code class="docutils literal notranslate"><span class="pre">names</span></code> and
<code class="docutils literal notranslate"><span class="pre">skiprows</span></code> arguments (and basically any argument you want to pass to
the file reader).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">file_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;./synthetic_csv/timestep_0.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;./synthetic_csv/timestep_1.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;./synthetic_csv/timestep_2.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;./synthetic_csv/timestep_3.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;./synthetic_csv/timestep_4.csv&quot;</span>
<span class="p">]</span>

<span class="n">X_arr</span><span class="p">,</span> <span class="n">label_dict</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">file_list</span><span class="p">,</span> <span class="n">read_file_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">],</span> <span class="s1">&#39;skiprows&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shape of X_arr is </span><span class="si">{</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="n">of</span> <span class="n">X_arr</span> <span class="ow">is</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">label_dict</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">]}</span>
</pre></div>
</div>
</section>
<section id="from-a-directory">
<h3>from a directory<a class="headerlink" href="#from-a-directory" title="Link to this heading">ÔÉÅ</a></h3>
<p>You can instead pass a directory path (as a string) to the <code class="docutils literal notranslate"><span class="pre">load_data</span></code>
function. In this case, the suffix (not file extension) of the filenames
will be used for ordering the files before loading them as different
timesteps. The suffix consists of characters after <code class="docutils literal notranslate"><span class="pre">suffix_sep</span></code> (not
including file extension). The default value for <code class="docutils literal notranslate"><span class="pre">suffix_sep</span></code> is an
undescore ‚Äú_‚Äú. E.g. if the ‚Äòsynthetic_csv‚Äô directory contains the
following files:</p>
<ul class="simple">
<li><p>timestep_1.csv</p></li>
<li><p>timestep_2.csv</p></li>
<li><p>timestep_3.csv</p></li>
<li><p>timestep_4.csv</p></li>
</ul>
<p>We can read the files as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_arr</span><span class="p">,</span> <span class="n">label_dict</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;./synthetic_csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shape of X_arr is </span><span class="si">{</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="n">of</span> <span class="n">X_arr</span> <span class="ow">is</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">label_dict</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
 <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
 <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
</pre></div>
</div>
<p>The suffixes of the filenames may not neccessarily start from 1 or have
an interval of 1. For example, the filenames could be:</p>
<ul class="simple">
<li><p>year-2000.csv</p></li>
<li><p>year-2005.csv</p></li>
<li><p>year-2010.csv</p></li>
<li><p>year-2015.csv</p></li>
<li><p>year-2020.csv</p></li>
</ul>
<p>So long the suffixes can be sorted and there is a consistent suffix
separator (‚Äú-‚Äù is this case), the directory can be parsed by
<code class="docutils literal notranslate"><span class="pre">load_data</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># checking how the head of a single</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./synthetic_csv2/year-2005.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
  <div id="df-b5ccaa66-53a1-495f-940f-38fc089d5b8a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>i1</td>
      <td>1.144403</td>
      <td>1.384766</td>
      <td>-0.296697</td>
    </tr>
    <tr>
      <th>1</th>
      <td>i2</td>
      <td>-0.221455</td>
      <td>-2.379010</td>
      <td>1.616871</td>
    </tr>
    <tr>
      <th>2</th>
      <td>i3</td>
      <td>1.533177</td>
      <td>-1.650524</td>
      <td>-0.548531</td>
    </tr>
    <tr>
      <th>3</th>
      <td>i4</td>
      <td>-0.615204</td>
      <td>0.794567</td>
      <td>-0.726242</td>
    </tr>
    <tr>
      <th>4</th>
      <td>i5</td>
      <td>0.622818</td>
      <td>-0.129735</td>
      <td>-0.723215</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b5ccaa66-53a1-495f-940f-38fc089d5b8a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b5ccaa66-53a1-495f-940f-38fc089d5b8a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b5ccaa66-53a1-495f-940f-38fc089d5b8a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-110d2bc1-5c74-41b6-bb90-fcaaa67e9d42">
  <button class="colab-df-quickchart" onclick="quickchart('df-110d2bc1-5c74-41b6-bb90-fcaaa67e9d42')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-110d2bc1-5c74-41b6-bb90-fcaaa67e9d42 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># if we were to indicate to pandas that the first column is the index and the first row is the header, we would have done</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./synthetic_csv2/year-2005.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
  <div id="df-3df444c1-7dc4-49c3-aa16-3cd7f934e8e6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>i1</th>
      <td>1.144403</td>
      <td>1.384766</td>
      <td>-0.296697</td>
    </tr>
    <tr>
      <th>i2</th>
      <td>-0.221455</td>
      <td>-2.379010</td>
      <td>1.616871</td>
    </tr>
    <tr>
      <th>i3</th>
      <td>1.533177</td>
      <td>-1.650524</td>
      <td>-0.548531</td>
    </tr>
    <tr>
      <th>i4</th>
      <td>-0.615204</td>
      <td>0.794567</td>
      <td>-0.726242</td>
    </tr>
    <tr>
      <th>i5</th>
      <td>0.622818</td>
      <td>-0.129735</td>
      <td>-0.723215</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3df444c1-7dc4-49c3-aa16-3cd7f934e8e6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3df444c1-7dc4-49c3-aa16-3cd7f934e8e6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3df444c1-7dc4-49c3-aa16-3cd7f934e8e6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5040aacd-f6a5-4b7f-a081-34c15a73e986">
  <button class="colab-df-quickchart" onclick="quickchart('df-5040aacd-f6a5-4b7f-a081-34c15a73e986')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5040aacd-f6a5-4b7f-a081-34c15a73e986 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># using load_data function</span>
<span class="n">X_arr</span><span class="p">,</span> <span class="n">label_dict</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;./synthetic_csv2&#39;</span><span class="p">,</span>
                              <span class="n">suffix_sep</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                              <span class="n">use_suffix_as_label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">read_file_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index_col&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shape of X_arr is </span><span class="si">{</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="n">of</span> <span class="n">X_arr</span> <span class="ow">is</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">label_dict</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">],</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">,</span> <span class="s1">&#39;i10&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i5&#39;</span><span class="p">,</span> <span class="s1">&#39;i6&#39;</span><span class="p">,</span> <span class="s1">&#39;i7&#39;</span><span class="p">,</span> <span class="s1">&#39;i8&#39;</span><span class="p">,</span> <span class="s1">&#39;i9&#39;</span><span class="p">],</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">]}</span>
</pre></div>
</div>
</section>
</section>
<section id="data-conversion">
<h2>Data Conversion<a class="headerlink" href="#data-conversion" title="Link to this heading">ÔÉÅ</a></h2>
<section id="to-dfs">
<h3>to_dfs<a class="headerlink" href="#to-dfs" title="Link to this heading">ÔÉÅ</a></h3>
<p>We can convert a 3-D array to a list of dataframes using the <code class="docutils literal notranslate"><span class="pre">to_dfs</span></code>
function. This is basically the reverse process of <code class="docutils literal notranslate"><span class="pre">load_dict</span></code> in that
it takes a 3-D array and an optional label_dict, and returns a list of
dataframes. Similar to <code class="docutils literal notranslate"><span class="pre">load_dict</span></code> function, you can use
<code class="docutils literal notranslate"><span class="pre">arr_format</span></code> and <code class="docutils literal notranslate"><span class="pre">output_df_format</span></code> to specify the format of the
input data and output data respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">to_dfs</span><span class="p">(</span><span class="n">X_arr</span><span class="p">,</span> <span class="n">label_dict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Length of dfs is: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">dfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># first five rows of the first dataframe in the list</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Length</span> <span class="n">of</span> <span class="n">dfs</span> <span class="ow">is</span><span class="p">:</span> <span class="mi">5</span>
</pre></div>
</div>
  <div id="df-42b84dd8-d52a-49ae-8418-25dd31d8d7ed" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>i1</th>
      <td>0.496714</td>
      <td>-0.138264</td>
      <td>-0.291524</td>
    </tr>
    <tr>
      <th>i10</th>
      <td>0.097078</td>
      <td>0.968645</td>
      <td>0.626228</td>
    </tr>
    <tr>
      <th>i2</th>
      <td>-0.463418</td>
      <td>-0.465730</td>
      <td>-0.312976</td>
    </tr>
    <tr>
      <th>i3</th>
      <td>1.465649</td>
      <td>-0.225776</td>
      <td>0.488591</td>
    </tr>
    <tr>
      <th>i4</th>
      <td>-0.601707</td>
      <td>1.852278</td>
      <td>-0.078235</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-42b84dd8-d52a-49ae-8418-25dd31d8d7ed')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-42b84dd8-d52a-49ae-8418-25dd31d8d7ed button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-42b84dd8-d52a-49ae-8418-25dd31d8d7ed');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4cff8a0f-75fc-4619-9f38-84deeccbec5c">
  <button class="colab-df-quickchart" onclick="quickchart('df-4cff8a0f-75fc-4619-9f38-84deeccbec5c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4cff8a0f-75fc-4619-9f38-84deeccbec5c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div></section>
<section id="tnf-to-ntf">
<h3>tnf_to_ntf<a class="headerlink" href="#tnf-to-ntf" title="Link to this heading">ÔÉÅ</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">tnf_to_ntf</span></code> function can be used to convert a data from ‚ÄòTNF‚Äô format
to ‚ÄòNTF‚Äô format. E.g</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of X_arr in &#39;TNF&#39; format is: </span><span class="si">{</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">X_arr_ntf</span> <span class="o">=</span> <span class="n">tnf_to_ntf</span><span class="p">(</span><span class="n">X_arr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of X_arr in &#39;NTF&#39; format is: </span><span class="si">{</span><span class="n">X_arr_ntf</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Shape</span> <span class="n">of</span> <span class="n">X_arr</span> <span class="ow">in</span> <span class="s1">&#39;TNF&#39;</span> <span class="nb">format</span> <span class="ow">is</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">Shape</span> <span class="n">of</span> <span class="n">X_arr</span> <span class="ow">in</span> <span class="s1">&#39;NTF&#39;</span> <span class="nb">format</span> <span class="ow">is</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="ntf-to-tnf">
<h3>ntf_to_tnf<a class="headerlink" href="#ntf-to-tnf" title="Link to this heading">ÔÉÅ</a></h3>
<p>Similarly, <code class="docutils literal notranslate"><span class="pre">ntf_to_tnf</span></code> function can be used to convert from ‚ÄòNTF‚Äô
format to ‚ÄòTNF‚Äô format. E.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of X_arr in &#39;NTF&#39; format is: </span><span class="si">{</span><span class="n">X_arr_ntf</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of X_arr in &#39;TNF&#39; format is: </span><span class="si">{</span><span class="n">ntf_to_tnf</span><span class="p">(</span><span class="n">X_arr_ntf</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Shape</span> <span class="n">of</span> <span class="n">X_arr</span> <span class="ow">in</span> <span class="s1">&#39;NTF&#39;</span> <span class="nb">format</span> <span class="ow">is</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">Shape</span> <span class="n">of</span> <span class="n">X_arr</span> <span class="ow">in</span> <span class="s1">&#39;TNF&#39;</span> <span class="nb">format</span> <span class="ow">is</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="broadcast-data">
<h3>broadcast_data<a class="headerlink" href="#broadcast-data" title="Link to this heading">ÔÉÅ</a></h3>
<p>If you want to broadcast a fixed cluster center along the time axis, you
can use <code class="docutils literal notranslate"><span class="pre">broadcast_data</span></code> function. E.g. if you have fixed cluster
centers as a 2-D array of shape (K, F), where K is the number of
clusters and F is the number of features; you can convert it to a 3-D
array such that the first axis is the time axis. This is usefule
especially when dealing with fixed center or fixed assignment because
they return (for memory efficiency) a 2-D array and a 1-D array
respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cluster_centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">cluster_centers</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mf">1.76405235</span><span class="p">,</span>  <span class="mf">0.40015721</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.97873798</span><span class="p">,</span>  <span class="mf">2.2408932</span> <span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.86755799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.97727788</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># number of time steps</span>
<span class="n">cluster_centers_broadcasted</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">broadcast_data</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cluster_centers</span><span class="p">)</span>
<span class="n">cluster_centers_broadcasted</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[[</span> <span class="mf">1.76405235</span><span class="p">,</span>  <span class="mf">0.40015721</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.97873798</span><span class="p">,</span>  <span class="mf">2.2408932</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.86755799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.97727788</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="mf">1.76405235</span><span class="p">,</span>  <span class="mf">0.40015721</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.97873798</span><span class="p">,</span>  <span class="mf">2.2408932</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.86755799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.97727788</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="mf">1.76405235</span><span class="p">,</span>  <span class="mf">0.40015721</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.97873798</span><span class="p">,</span>  <span class="mf">2.2408932</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.86755799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.97727788</span><span class="p">]]])</span>
</pre></div>
</div>
<p>You can also broadcast labels. E.g if the cluster labels is a 1-D numpy
array of shape (N, ).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">labels</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># number of time steps</span>
<span class="n">_</span><span class="p">,</span> <span class="n">labels_broadcasted</span> <span class="o">=</span> <span class="n">broadcast_data</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">labels_broadcasted</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
<p>You can also broadcast both cluster_centers and labels at the same time</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># number of time steps</span>
<span class="n">cluster_centers_broadcasted</span><span class="p">,</span> <span class="n">labels_broadcasted</span> <span class="o">=</span> <span class="n">broadcast_data</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cluster_centers</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">cluster_centers_broadcasted</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[[</span> <span class="mf">1.76405235</span><span class="p">,</span>  <span class="mf">0.40015721</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.97873798</span><span class="p">,</span>  <span class="mf">2.2408932</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.86755799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.97727788</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="mf">1.76405235</span><span class="p">,</span>  <span class="mf">0.40015721</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.97873798</span><span class="p">,</span>  <span class="mf">2.2408932</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.86755799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.97727788</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="mf">1.76405235</span><span class="p">,</span>  <span class="mf">0.40015721</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.97873798</span><span class="p">,</span>  <span class="mf">2.2408932</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.86755799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.97727788</span><span class="p">]]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">labels_broadcasted</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</section>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">preprocessing</span></code> module has two main scalers: <code class="docutils literal notranslate"><span class="pre">TSStandardScaler</span></code>
and <code class="docutils literal notranslate"><span class="pre">TSMinMaxScaler</span></code>.</p>
<section id="tsstandardscaler">
<h3>TSStandardScaler<a class="headerlink" href="#tsstandardscaler" title="Link to this heading">ÔÉÅ</a></h3>
<p>This scaler uses sklearn‚Äôs StandardScaler to scale a time series data.
Scaling can be done per timesteps (default) or per feature</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> methods. During <code class="docutils literal notranslate"><span class="pre">fit</span></code>, the scaler
parameters are stored. They will be used for <code class="docutils literal notranslate"><span class="pre">tranform</span></code> and
<code class="docutils literal notranslate"><span class="pre">inverse-tansform</span></code> of data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">TSStandardScaler</span><span class="p">(</span><span class="n">per_time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># initialize a time series standard scaler</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_arr</span><span class="p">)</span> <span class="c1"># fit</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_arr</span><span class="p">)</span> <span class="c1"># transform</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X_scaled shape is </span><span class="si">{</span><span class="n">X_scaled</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First five entities for the first time step are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_scaled</span> <span class="n">shape</span> <span class="ow">is</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">First</span> <span class="n">five</span> <span class="n">entities</span> <span class="k">for</span> <span class="n">the</span> <span class="n">first</span> <span class="n">time</span> <span class="n">step</span> <span class="n">are</span><span class="p">:</span>
<span class="p">[[</span> <span class="mf">0.53075651</span> <span class="o">-</span><span class="mf">0.62117007</span> <span class="o">-</span><span class="mf">0.2344527</span> <span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.12234591</span>  <span class="mf">0.79082039</span>  <span class="mf">0.91426627</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">1.03833007</span> <span class="o">-</span><span class="mf">1.03889002</span> <span class="o">-</span><span class="mf">0.26130345</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">2.11422893</span> <span class="o">-</span><span class="mf">0.73280172</span>  <span class="mf">0.74199078</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">1.26432746</span>  <span class="mf">1.91799644</span>  <span class="mf">0.03251411</span><span class="p">]]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> can be done with a single method called
<code class="docutils literal notranslate"><span class="pre">fit_transform</span></code>. E.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">TSStandardScaler</span><span class="p">(</span><span class="n">per_time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># initialize a time series standard scaler</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_arr</span><span class="p">)</span> <span class="c1"># fit and transform at the same time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X_scaled shape is </span><span class="si">{</span><span class="n">X_scaled</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First five entities for the first time step are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_scaled</span> <span class="n">shape</span> <span class="ow">is</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">First</span> <span class="n">five</span> <span class="n">entities</span> <span class="k">for</span> <span class="n">the</span> <span class="n">first</span> <span class="n">time</span> <span class="n">step</span> <span class="n">are</span><span class="p">:</span>
<span class="p">[[</span> <span class="mf">0.53075651</span> <span class="o">-</span><span class="mf">0.62117007</span> <span class="o">-</span><span class="mf">0.2344527</span> <span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.12234591</span>  <span class="mf">0.79082039</span>  <span class="mf">0.91426627</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">1.03833007</span> <span class="o">-</span><span class="mf">1.03889002</span> <span class="o">-</span><span class="mf">0.26130345</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">2.11422893</span> <span class="o">-</span><span class="mf">0.73280172</span>  <span class="mf">0.74199078</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">1.26432746</span>  <span class="mf">1.91799644</span>  <span class="mf">0.03251411</span><span class="p">]]</span>
</pre></div>
</div>
<p>We can use <code class="docutils literal notranslate"><span class="pre">inverse-tranform</span></code> method to reverse the transformation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First five entities for the first time step of the original data are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First five entities for the first time step of the inverse tranform of X_scaled are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">First</span> <span class="n">five</span> <span class="n">entities</span> <span class="k">for</span> <span class="n">the</span> <span class="n">first</span> <span class="n">time</span> <span class="n">step</span> <span class="n">of</span> <span class="n">the</span> <span class="n">original</span> <span class="n">data</span> <span class="n">are</span><span class="p">:</span>
<span class="p">[[</span> <span class="mf">0.49671415</span> <span class="o">-</span><span class="mf">0.1382643</span>  <span class="o">-</span><span class="mf">0.29152375</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">0.09707755</span>  <span class="mf">0.96864499</span>  <span class="mf">0.62622751</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.46341769</span> <span class="o">-</span><span class="mf">0.46572975</span> <span class="o">-</span><span class="mf">0.31297574</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">1.46564877</span> <span class="o">-</span><span class="mf">0.2257763</span>   <span class="mf">0.48859067</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.60170661</span>  <span class="mf">1.85227818</span> <span class="o">-</span><span class="mf">0.07823474</span><span class="p">]]</span>

<span class="n">First</span> <span class="n">five</span> <span class="n">entities</span> <span class="k">for</span> <span class="n">the</span> <span class="n">first</span> <span class="n">time</span> <span class="n">step</span> <span class="n">of</span> <span class="n">the</span> <span class="n">inverse</span> <span class="n">tranform</span> <span class="n">of</span> <span class="n">X_scaled</span> <span class="n">are</span><span class="p">:</span>
<span class="p">[[</span> <span class="mf">0.49671415</span> <span class="o">-</span><span class="mf">0.1382643</span>  <span class="o">-</span><span class="mf">0.29152375</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">0.09707755</span>  <span class="mf">0.96864499</span>  <span class="mf">0.62622751</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.46341769</span> <span class="o">-</span><span class="mf">0.46572975</span> <span class="o">-</span><span class="mf">0.31297574</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">1.46564877</span> <span class="o">-</span><span class="mf">0.2257763</span>   <span class="mf">0.48859067</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.60170661</span>  <span class="mf">1.85227818</span> <span class="o">-</span><span class="mf">0.07823474</span><span class="p">]]</span>
</pre></div>
</div>
</section>
<section id="tsminmaxscaler">
<h3>TSMinMaxScaler<a class="headerlink" href="#tsminmaxscaler" title="Link to this heading">ÔÉÅ</a></h3>
<p>The same methods of <code class="docutils literal notranslate"><span class="pre">TSStandardScaler</span></code> applies to <code class="docutils literal notranslate"><span class="pre">TSMinMaxScaler</span></code></p>
<p>This scaler uses sklearn‚Äôs MinMaxScaler to scale a time series data.
Scaling can be done per timesteps (default) or per feature</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> methods.</p>
<p>During <code class="docutils literal notranslate"><span class="pre">fit</span></code>, the scaler parameters are stored. They will be used for
<code class="docutils literal notranslate"><span class="pre">tranform</span></code> and <code class="docutils literal notranslate"><span class="pre">inverse-tansform</span></code> of data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">TSMinMaxScaler</span><span class="p">(</span><span class="n">per_time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># initialize a time series minmax scaler</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_arr</span><span class="p">)</span> <span class="c1"># fit</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_arr</span><span class="p">)</span> <span class="c1"># transform</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X_scaled shape is </span><span class="si">{</span><span class="n">X_scaled</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First five entities for the first time step are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_scaled</span> <span class="n">shape</span> <span class="ow">is</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">First</span> <span class="n">five</span> <span class="n">entities</span> <span class="k">for</span> <span class="n">the</span> <span class="n">first</span> <span class="n">time</span> <span class="n">step</span> <span class="n">are</span><span class="p">:</span>
<span class="p">[[</span><span class="mf">0.53131686</span> <span class="mf">0.1412702</span>  <span class="mf">0.40094123</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">0.33800873</span> <span class="mf">0.6187963</span>  <span class="mf">0.75951472</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">0.0668917</span>  <span class="mf">0.</span>         <span class="mf">0.39255975</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">1.</span>         <span class="mf">0.1035171</span>  <span class="mf">0.7057388</span> <span class="p">]</span>
 <span class="p">[</span><span class="mf">0.</span>         <span class="mf">1.</span>         <span class="mf">0.48427512</span><span class="p">]]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> can be done with a single method called
<code class="docutils literal notranslate"><span class="pre">fit_transform</span></code>. E.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">TSMinMaxScaler</span><span class="p">(</span><span class="n">per_time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># initialize a time series minmax scaler</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_arr</span><span class="p">)</span> <span class="c1"># fit and transform at the same time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X_scaled shape is </span><span class="si">{</span><span class="n">X_scaled</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First five entities for the first time step are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_scaled</span> <span class="n">shape</span> <span class="ow">is</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">First</span> <span class="n">five</span> <span class="n">entities</span> <span class="k">for</span> <span class="n">the</span> <span class="n">first</span> <span class="n">time</span> <span class="n">step</span> <span class="n">are</span><span class="p">:</span>
<span class="p">[[</span><span class="mf">0.53131686</span> <span class="mf">0.1412702</span>  <span class="mf">0.40094123</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">0.33800873</span> <span class="mf">0.6187963</span>  <span class="mf">0.75951472</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">0.0668917</span>  <span class="mf">0.</span>         <span class="mf">0.39255975</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">1.</span>         <span class="mf">0.1035171</span>  <span class="mf">0.7057388</span> <span class="p">]</span>
 <span class="p">[</span><span class="mf">0.</span>         <span class="mf">1.</span>         <span class="mf">0.48427512</span><span class="p">]]</span>
</pre></div>
</div>
<p>We can use <code class="docutils literal notranslate"><span class="pre">inverse-tranform</span></code> method to reverse the transformation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First five entities for the first time step of the original data are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First five entities for the first time step of the inverse tranform of X_scaled are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">First</span> <span class="n">five</span> <span class="n">entities</span> <span class="k">for</span> <span class="n">the</span> <span class="n">first</span> <span class="n">time</span> <span class="n">step</span> <span class="n">of</span> <span class="n">the</span> <span class="n">original</span> <span class="n">data</span> <span class="n">are</span><span class="p">:</span>
<span class="p">[[</span> <span class="mf">0.49671415</span> <span class="o">-</span><span class="mf">0.1382643</span>  <span class="o">-</span><span class="mf">0.29152375</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">0.09707755</span>  <span class="mf">0.96864499</span>  <span class="mf">0.62622751</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.46341769</span> <span class="o">-</span><span class="mf">0.46572975</span> <span class="o">-</span><span class="mf">0.31297574</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">1.46564877</span> <span class="o">-</span><span class="mf">0.2257763</span>   <span class="mf">0.48859067</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.60170661</span>  <span class="mf">1.85227818</span> <span class="o">-</span><span class="mf">0.07823474</span><span class="p">]]</span>

<span class="n">First</span> <span class="n">five</span> <span class="n">entities</span> <span class="k">for</span> <span class="n">the</span> <span class="n">first</span> <span class="n">time</span> <span class="n">step</span> <span class="n">of</span> <span class="n">the</span> <span class="n">inverse</span> <span class="n">tranform</span> <span class="n">of</span> <span class="n">X_scaled</span> <span class="n">are</span><span class="p">:</span>
<span class="p">[[</span> <span class="mf">0.49671415</span> <span class="o">-</span><span class="mf">0.1382643</span>  <span class="o">-</span><span class="mf">0.29152375</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">0.09707755</span>  <span class="mf">0.96864499</span>  <span class="mf">0.62622751</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.46341769</span> <span class="o">-</span><span class="mf">0.46572975</span> <span class="o">-</span><span class="mf">0.31297574</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">1.46564877</span> <span class="o">-</span><span class="mf">0.2257763</span>   <span class="mf">0.48859067</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.60170661</span>  <span class="mf">1.85227818</span> <span class="o">-</span><span class="mf">0.07823474</span><span class="p">]]</span>
</pre></div>
</div>
</section>
</section>
<section id="metrics">
<h2>Metrics<a class="headerlink" href="#metrics" title="Link to this heading">ÔÉÅ</a></h2>
<p>There are currently two metrics in <code class="docutils literal notranslate"><span class="pre">tscluster</span></code> package: <code class="docutils literal notranslate"><span class="pre">inertia</span></code>
and <code class="docutils literal notranslate"><span class="pre">max_dist</span></code>.</p>
<p>The inertia is calculated as:</p>
<div class="math notranslate nohighlight">
\[\sum_{t=1}^{T} \sum_{i=1}^{N} D(X_{ti}, Z_t)\]</div>
<p>Where - <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(N\)</span> are the number of time steps and entities
respectively - <span class="math notranslate nohighlight">\(D\)</span> is a distance function (or metric e.g
<span class="math notranslate nohighlight">\(L_1\)</span> distance, <span class="math notranslate nohighlight">\(L_2\)</span> distance etc) - <span class="math notranslate nohighlight">\(f\)</span> is the
number of features - <span class="math notranslate nohighlight">\(X_{ti} \in \mathbf{R}^f\)</span> is the feature
vector of entity <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> -
<span class="math notranslate nohighlight">\(Z_t \in \mathbf{R}^f\)</span> is the cluster center <span class="math notranslate nohighlight">\(X_{ti}\)</span> is
assigned to at time <span class="math notranslate nohighlight">\(t\)</span></p>
<p>The max_dist is calculated as:</p>
<div class="math notranslate nohighlight">
\[max(D(X_{ti}, Z_t))\]</div>
<p>Where - <span class="math notranslate nohighlight">\(D\)</span> is a distance function (or metric e.g
<span class="math notranslate nohighlight">\(L_1\)</span>distance, <span class="math notranslate nohighlight">\(L_2\)</span> distance etc) - <span class="math notranslate nohighlight">\(f\)</span> is the
number of features - <span class="math notranslate nohighlight">\(X_{ti} \in \mathbf{R}^f\)</span> is the feature
vector of entity <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t\)</span>, -
<span class="math notranslate nohighlight">\(Z_t \in \mathbf{R}^f\)</span> is the cluster center <span class="math notranslate nohighlight">\(X_{ti}\)</span> is
assigned to at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Both <code class="docutils literal notranslate"><span class="pre">inertia</span></code> and <code class="docutils literal notranslate"><span class="pre">max_dist</span></code> functions take four arguments: 1. The
data X (in TNF format) 2. cluster_centers 3. labels 4. ord (which
specifies the order of the Minkowski distance)</p>
<p>They can also take both 3-D and 2-D arrays for dynamic and fixed cluster
centers respectively, and 2-D and 1-D arrays for dynamic and fixed
labels respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># using fixed cluster centers and dynamic label assignment</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cluster_centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># 2-D array (for fixed cluster)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1"># 2-D array (for dynamic labels)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inertia score is </span><span class="si">{</span><span class="n">inertia</span><span class="p">(</span><span class="n">X_arr</span><span class="p">,</span><span class="w"> </span><span class="n">cluster_centers</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_dist score is </span><span class="si">{</span><span class="n">max_dist</span><span class="p">(</span><span class="n">X_arr</span><span class="p">,</span><span class="w"> </span><span class="n">cluster_centers</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">217.22127047719061</span>
<span class="n">max_dist</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">10.202923513064336</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># using dynamic cluster centers and fixed label assignment</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cluster_centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># 3-D array (for dynamic cluster)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># 1-D array (for fixed labels)</span>
<span class="n">labels</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inertia score is </span><span class="si">{</span><span class="n">inertia</span><span class="p">(</span><span class="n">X_arr</span><span class="p">,</span><span class="w"> </span><span class="n">cluster_centers</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l2 distance</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_dist score is </span><span class="si">{</span><span class="n">max_dist</span><span class="p">(</span><span class="n">X_arr</span><span class="p">,</span><span class="w"> </span><span class="n">cluster_centers</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l2 distance</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">138.29240897541072</span>
<span class="n">max_dist</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">7.3157146070128745</span>
</pre></div>
</div>
</section>
<section id="tsplot">
<h2>TSPlot<a class="headerlink" href="#tsplot" title="Link to this heading">ÔÉÅ</a></h2>
<section id="plot">
<h3>plot<a class="headerlink" href="#plot" title="Link to this heading">ÔÉÅ</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">plot</span></code> function is used to plot a time series plots of the different
features in a time series data</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_arr</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_92_0.png" src="../../../_images/tscluster_tutorial_92_0.png" />
<p>We can add label assignment to the plot</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_arr</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_94_0.png" src="../../../_images/tscluster_tutorial_94_0.png" />
<p>We can plot only cluster centers</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cluster_centers</span><span class="o">=</span><span class="n">cluster_centers</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_96_0.png" src="../../../_images/tscluster_tutorial_96_0.png" />
<p>We can plot all of data X, cluster centers and label assignment in the
same plot</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_arr</span><span class="p">,</span> <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cluster_centers</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="c1"># note that the cluster centers are not meaningfull since they were randomly generated</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_98_0.png" src="../../../_images/tscluster_tutorial_98_0.png" />
<p>We can also annotate only specific entities by passing their index to
the <code class="docutils literal notranslate"><span class="pre">entity_idx</span></code> parameter</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_arr</span><span class="p">,</span> <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cluster_centers</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">entity_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_100_0.png" src="../../../_images/tscluster_tutorial_100_0.png" />
<p>We can show only the entities in <code class="docutils literal notranslate"><span class="pre">entity_idx</span></code> by setting
<code class="docutils literal notranslate"><span class="pre">show_all_entities</span></code> to False</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_arr</span><span class="p">,</span> <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cluster_centers</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">entity_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">show_all_entities</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_102_0.png" src="../../../_images/tscluster_tutorial_102_0.png" />
<p>We can use the labels in label_dict to label the entities in
<code class="docutils literal notranslate"><span class="pre">entity_idx</span></code> by passing <code class="docutils literal notranslate"><span class="pre">label_dict</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># recall our label dict</span>
<span class="n">label_dict</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">],</span>
 <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">,</span> <span class="s1">&#39;i10&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i5&#39;</span><span class="p">,</span> <span class="s1">&#39;i6&#39;</span><span class="p">,</span> <span class="s1">&#39;i7&#39;</span><span class="p">,</span> <span class="s1">&#39;i8&#39;</span><span class="p">,</span> <span class="s1">&#39;i9&#39;</span><span class="p">],</span>
 <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X_arr</span><span class="p">,</span>
    <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cluster_centers</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">entity_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
    <span class="n">show_all_entities</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">label_dict</span><span class="o">=</span><span class="n">label_dict</span>
<span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_105_0.png" src="../../../_images/tscluster_tutorial_105_0.png" />
<p>We can pass custom labels to the labels in <code class="docutils literal notranslate"><span class="pre">entity_idx</span></code> using the
<code class="docutils literal notranslate"><span class="pre">entities_labels</span></code> parameter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X_arr</span><span class="p">,</span>
    <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cluster_centers</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">entity_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
    <span class="n">entities_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;e0&#39;</span><span class="p">,</span> <span class="s1">&#39;e4&#39;</span><span class="p">,</span> <span class="s1">&#39;e9&#39;</span><span class="p">],</span>
    <span class="n">show_all_entities</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_107_0.png" src="../../../_images/tscluster_tutorial_107_0.png" />
<p>We can also pass custom labels for the cluster centers using the
<code class="docutils literal notranslate"><span class="pre">cluster_labels</span></code> parameter</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X_arr</span><span class="p">,</span>
    <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cluster_centers</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">entity_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
    <span class="n">entities_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;e0&#39;</span><span class="p">,</span> <span class="s1">&#39;e4&#39;</span><span class="p">,</span> <span class="s1">&#39;e9&#39;</span><span class="p">],</span>
    <span class="n">show_all_entities</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">label_dict</span><span class="o">=</span><span class="n">label_dict</span><span class="p">,</span>
    <span class="n">cluster_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_109_0.png" src="../../../_images/tscluster_tutorial_109_0.png" />
</section>
<section id="waterfall-plot">
<h3>waterfall_plot<a class="headerlink" href="#waterfall-plot" title="Link to this heading">ÔÉÅ</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">waterfall_plot</span></code> can be used to generate a 3-D time series plot of a
particular entity or cluster center.</p>
<p>To make the plot interactive, use a suitable matplotlib‚Äôs magic command.
E.g. <code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">widget</span></code>. See this site for more:
<a class="reference external" href="https://matplotlib.org/stable/users/explain/figure/interactive.html">https://matplotlib.org/stable/users/explain/figure/interactive.html</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># waterfall plot of a single entity</span>
<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">waterfall_plot</span><span class="p">(</span><span class="n">X_arr</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_112_0.png" src="../../../_images/tscluster_tutorial_112_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># waterfall plot of a single cluster center</span>
<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">waterfall_plot</span><span class="p">(</span><span class="n">cluster_centers</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_113_0.png" src="../../../_images/tscluster_tutorial_113_0.png" />
</section>
</section>
<section id="temporal-clustering-models">
<h2>Temporal Clustering Models<a class="headerlink" href="#temporal-clustering-models" title="Link to this heading">ÔÉÅ</a></h2>
<p>All temporal clustering modules implements a <code class="docutils literal notranslate"><span class="pre">fit</span></code> method (in which on
executing, compute the cluster centers and label assignments).</p>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">cluster_centers_</span></code> and <code class="docutils literal notranslate"><span class="pre">labels_</span></code> attributes to
retreive the cluster centers and label assignments respectively. Here we
used sklearn‚Äôs convention of using trailing underscores for attributes
whose values are known only after fitting.</p>
<section id="opttscluster">
<h3>OptTSCluster<a class="headerlink" href="#opttscluster" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>fixed centers, dynamic assignment</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize the model</span>
<span class="n">opt_ts</span> <span class="o">=</span> <span class="n">OptTSCluster</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;z0c1&#39;</span><span class="p">,</span> <span class="c1"># fixed centers, dynamic assignment</span>
    <span class="n">n_allow_assignment_change</span><span class="o">=</span><span class="kc">None</span> <span class="c1"># number of changes to allow, None means allow as many changes as possible</span>
    <span class="c1"># warm_start=True # warm start with kmeans</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_size</span> <span class="o">=</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">get_model_size</span><span class="p">(</span><span class="n">X_arr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;model has </span><span class="si">{</span><span class="n">model_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> variables and </span><span class="si">{</span><span class="n">model_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> constraints&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Restricted</span> <span class="n">license</span> <span class="o">-</span> <span class="k">for</span> <span class="n">non</span><span class="o">-</span><span class="n">production</span> <span class="n">use</span> <span class="n">only</span> <span class="o">-</span> <span class="n">expires</span> <span class="mi">2025</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">24</span>
<span class="n">model</span> <span class="n">has</span> <span class="mi">610</span> <span class="n">variables</span> <span class="ow">and</span> <span class="mi">950</span> <span class="n">constraints</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">label_dict</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">],</span>
 <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">,</span> <span class="s1">&#39;i10&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i5&#39;</span><span class="p">,</span> <span class="s1">&#39;i6&#39;</span><span class="p">,</span> <span class="s1">&#39;i7&#39;</span><span class="p">,</span> <span class="s1">&#39;i8&#39;</span><span class="p">,</span> <span class="s1">&#39;i9&#39;</span><span class="p">],</span>
 <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit the model</span>
<span class="n">opt_ts</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_arr</span><span class="p">,</span> <span class="n">label_dict</span><span class="o">=</span><span class="n">label_dict</span><span class="p">);</span> <span class="c1"># we can optionally pass the label dict to the model during fit</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Warm</span> <span class="n">starting</span><span class="o">...</span>
<span class="n">Done</span> <span class="k">with</span> <span class="n">warm</span> <span class="n">start</span> <span class="n">after</span> <span class="mf">0.04</span><span class="n">secs</span>

<span class="n">Obj</span> <span class="n">val</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.77787002</span><span class="p">]</span>

<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.86</span><span class="n">secs</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># checking the label dict</span>
<span class="n">opt_ts</span><span class="o">.</span><span class="n">label_dict_</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">],</span>
 <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">,</span> <span class="s1">&#39;i10&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i5&#39;</span><span class="p">,</span> <span class="s1">&#39;i6&#39;</span><span class="p">,</span> <span class="s1">&#39;i7&#39;</span><span class="p">,</span> <span class="s1">&#39;i8&#39;</span><span class="p">,</span> <span class="s1">&#39;i9&#39;</span><span class="p">],</span>
 <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># retrieving the index of the some time labels</span>
<span class="n">opt_ts</span><span class="o">.</span><span class="n">get_index_of_label</span><span class="p">([</span><span class="s1">&#39;2005&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># retrieving the labels of the some entity indexes</span>
<span class="n">opt_ts</span><span class="o">.</span><span class="n">get_label_of_index</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;i10&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">,</span> <span class="s1">&#39;i1&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>We can get the cluster centers as a dataframe with the labels in
<code class="docutils literal notranslate"><span class="pre">label_dict</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_centers_lst</span> <span class="o">=</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">get_named_cluster_centers</span><span class="p">()</span>
<span class="n">cluster_centers_lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># first cluster</span>
</pre></div>
</div>
  <div id="df-2a8b3070-b3b0-411e-aa58-10d8d88bffc2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000</th>
      <td>-2.028199</td>
      <td>-2.377959</td>
      <td>-0.353205</td>
    </tr>
    <tr>
      <th>2005</th>
      <td>-2.028199</td>
      <td>-2.377959</td>
      <td>-0.353205</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>-2.028199</td>
      <td>-2.377959</td>
      <td>-0.353205</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>-2.028199</td>
      <td>-2.377959</td>
      <td>-0.353205</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>-2.028199</td>
      <td>-2.377959</td>
      <td>-0.353205</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2a8b3070-b3b0-411e-aa58-10d8d88bffc2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2a8b3070-b3b0-411e-aa58-10d8d88bffc2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2a8b3070-b3b0-411e-aa58-10d8d88bffc2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3a942c1d-7fe3-4c38-92af-070e5919a41d">
  <button class="colab-df-quickchart" onclick="quickchart('df-3a942c1d-7fe3-4c38-92af-070e5919a41d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3a942c1d-7fe3-4c38-92af-070e5919a41d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div><p>We can also get the labels as a dataframe indexed with labels in
<code class="docutils literal notranslate"><span class="pre">label_dict</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opt_ts</span><span class="o">.</span><span class="n">get_named_labels</span><span class="p">()</span>
</pre></div>
</div>
  <div id="df-803de4a2-64ee-4665-9c5f-d0e7382b65ae" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2000</th>
      <th>2005</th>
      <th>2010</th>
      <th>2015</th>
      <th>2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>i1</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>i10</th>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>i2</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>i3</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>i4</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>i5</th>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>i6</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>i7</th>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>i8</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>i9</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-803de4a2-64ee-4665-9c5f-d0e7382b65ae')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-803de4a2-64ee-4665-9c5f-d0e7382b65ae button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-803de4a2-64ee-4665-9c5f-d0e7382b65ae');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-bc0c871a-dd13-4e74-9d60-7334a35a3408">
  <button class="colab-df-quickchart" onclick="quickchart('df-bc0c871a-dd13-4e74-9d60-7334a35a3408')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-bc0c871a-dd13-4e74-9d60-7334a35a3408 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div><p>Checking most dynamic entities</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;total number of cluster changes is: </span><span class="si">{</span><span class="n">opt_ts</span><span class="o">.</span><span class="n">n_changes_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">opt_ts</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()</span> <span class="c1"># dynamic entities and their number of cluster changes</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">cluster</span> <span class="n">changes</span> <span class="ow">is</span><span class="p">:</span> <span class="mi">19</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">([</span><span class="s1">&#39;i5&#39;</span><span class="p">,</span> <span class="s1">&#39;i7&#39;</span><span class="p">,</span> <span class="s1">&#39;i10&#39;</span><span class="p">,</span> <span class="s1">&#39;i8&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">,</span> <span class="s1">&#39;i9&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;i1&#39;</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># retrieve the cluster centers and labels</span>
<span class="n">cc_opt_ts</span> <span class="o">=</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">cluster_centers_</span>
<span class="n">labels_opt_ts</span> <span class="o">=</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">labels_</span>
<span class="n">labels_opt_ts</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot model results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_arr</span><span class="p">,</span> <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cc_opt_ts</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_opt_ts</span><span class="p">,</span> <span class="n">label_dict</span><span class="o">=</span><span class="n">opt_ts</span><span class="o">.</span><span class="n">label_dict_</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_132_0.png" src="../../../_images/tscluster_tutorial_132_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># waterfall plot of a particular cluster center</span>
<span class="n">cc_idx</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># index of cluster center to plot</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">broadcast_data</span><span class="p">(</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cc_opt_ts</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:,</span> <span class="n">cc_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="c1"># broadcasting the cluster center</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">waterfall_plot</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">label_dict</span><span class="o">=</span><span class="n">opt_ts</span><span class="o">.</span><span class="n">label_dict_</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Water fall plot of cluster center </span><span class="si">{</span><span class="n">cc_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_133_0.png" src="../../../_images/tscluster_tutorial_133_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># waterfall plot of most dynamic entity</span>
<span class="n">most_dynamic_entity_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">opt_ts</span><span class="o">.</span><span class="n">get_named_labels</span><span class="p">()</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">waterfall_plot</span><span class="p">(</span><span class="n">X_arr</span><span class="p">[:,</span> <span class="n">most_dynamic_entity_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label_dict</span><span class="o">=</span><span class="n">opt_ts</span><span class="o">.</span><span class="n">label_dict_</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Water fall plot of most dynamic entity&quot;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_134_0.png" src="../../../_images/tscluster_tutorial_134_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># scoring the model</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inertia score is </span><span class="si">{</span><span class="n">inertia</span><span class="p">(</span><span class="n">X_arr</span><span class="p">,</span><span class="w"> </span><span class="n">cc_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="n">labels_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_dist score is </span><span class="si">{</span><span class="n">max_dist</span><span class="p">(</span><span class="n">X_arr</span><span class="p">,</span><span class="w"> </span><span class="n">cc_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="n">labels_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">138.84033246055895</span>
<span class="n">max_dist</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">3.777870015440997</span>
</pre></div>
</div>
<p>We can also set the label_dict after fitting</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">old_label_dict</span> <span class="o">=</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">label_dict_</span>
<span class="n">old_label_dict</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">],</span>
 <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">,</span> <span class="s1">&#39;i10&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i5&#39;</span><span class="p">,</span> <span class="s1">&#39;i6&#39;</span><span class="p">,</span> <span class="s1">&#39;i7&#39;</span><span class="p">,</span> <span class="s1">&#39;i8&#39;</span><span class="p">,</span> <span class="s1">&#39;i9&#39;</span><span class="p">],</span>
 <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_label_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">old_label_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">new_label_dict</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>

<span class="n">opt_ts</span><span class="o">.</span><span class="n">set_label_dict</span><span class="p">(</span><span class="n">new_label_dict</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opt_ts</span><span class="o">.</span><span class="n">label_dict_</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">],</span>
 <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">,</span> <span class="s1">&#39;i10&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i5&#39;</span><span class="p">,</span> <span class="s1">&#39;i6&#39;</span><span class="p">,</span> <span class="s1">&#39;i7&#39;</span><span class="p">,</span> <span class="s1">&#39;i8&#39;</span><span class="p">,</span> <span class="s1">&#39;i9&#39;</span><span class="p">],</span>
 <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<p><strong>dynamic centers, fixed assignment</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># loading the data</span>
<span class="n">X_arr2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;./sythetic_data.npy&quot;</span><span class="p">)</span>
<span class="n">X_arr2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># visualizing the data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_arr2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_142_0.png" src="../../../_images/tscluster_tutorial_142_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize the model</span>
<span class="n">opt_ts</span> <span class="o">=</span> <span class="n">OptTSCluster</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;z1c1&#39;</span><span class="p">,</span> <span class="c1"># dynamic centers, dynamic assignment. Scheme needs to be a dynamic label scheme when using constrained cluster change</span>
                   <span class="c1"># you can also use &#39;z1c0&#39; scheme here</span>
    <span class="n">n_allow_assignment_change</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># number of changes to allow, 0 means allow as no changes are allowed.</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># warm start with kmeans</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># checking the size of the model</span>
<span class="n">model_size</span> <span class="o">=</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">get_model_size</span><span class="p">(</span><span class="n">X_arr2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;model has </span><span class="si">{</span><span class="n">model_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> variables and </span><span class="si">{</span><span class="n">model_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> constraints&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="n">has</span> <span class="mi">1066</span> <span class="n">variables</span> <span class="ow">and</span> <span class="mi">1051</span> <span class="n">constraints</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit the model</span>
<span class="n">opt_ts</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_arr2</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Warm</span> <span class="n">starting</span><span class="o">...</span>
<span class="n">Done</span> <span class="k">with</span> <span class="n">warm</span> <span class="n">start</span> <span class="n">after</span> <span class="mf">0.08</span><span class="n">secs</span>

<span class="n">Obj</span> <span class="n">val</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.51774178</span><span class="p">]</span>

<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">0.19</span><span class="n">secs</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;total number of cluster changes is: </span><span class="si">{</span><span class="n">opt_ts</span><span class="o">.</span><span class="n">n_changes_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">opt_ts</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()</span> <span class="c1"># indexes of dynamic entities and their number of cluster changes</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">cluster</span> <span class="n">changes</span> <span class="ow">is</span><span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">([],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># retrieve the cluster centers and labels</span>
<span class="n">cc_opt_ts</span> <span class="o">=</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">cluster_centers_</span>
<span class="n">labels_opt_ts</span> <span class="o">=</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">labels_opt_ts</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot of model results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_arr2</span><span class="p">,</span> <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cc_opt_ts</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_opt_ts</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_149_0.png" src="../../../_images/tscluster_tutorial_149_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># scoring the model</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inertia score is </span><span class="si">{</span><span class="n">inertia</span><span class="p">(</span><span class="n">X_arr2</span><span class="p">,</span><span class="w"> </span><span class="n">cc_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="n">labels_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_dist score is </span><span class="si">{</span><span class="n">max_dist</span><span class="p">(</span><span class="n">X_arr2</span><span class="p">,</span><span class="w"> </span><span class="n">cc_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="n">labels_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">117.50053747638934</span>
<span class="n">max_dist</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">1.5177417770731711</span>
</pre></div>
</div>
<section id="bounded-changes">
<h4>Bounded Changes<a class="headerlink" href="#bounded-changes" title="Link to this heading">ÔÉÅ</a></h4>
<p><strong>Creating dynamic entities</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dynamic_X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">X_arr2</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">X_arr2</span><span class="p">[</span><span class="mi">3</span><span class="p">:,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">dynamic_X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">X_arr2</span><span class="p">[:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="p">:],</span> <span class="n">X_arr2</span><span class="p">[</span><span class="mi">6</span><span class="p">:,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">:]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_arr3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">X_arr2</span><span class="p">,</span> <span class="n">dynamic_X1</span><span class="p">,</span> <span class="n">dynamic_X2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_arr3</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting the synthetically created dynamic entities</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_arr3</span><span class="p">,</span> <span class="n">entity_idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">X_arr2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_arr3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">show_all_entities</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_155_0.png" src="../../../_images/tscluster_tutorial_155_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize the model</span>
<span class="n">opt_ts</span> <span class="o">=</span> <span class="n">OptTSCluster</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;z1c1&#39;</span><span class="p">,</span> <span class="c1"># dynamic centers, dynamic assignment. Scheme needs to be a dynamic label scheme when using constrained cluster change</span>
    <span class="n">n_allow_assignment_change</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="c1"># number of changes to allow, None means allow as many changes as possible</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># warm start with kmeans</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit the model</span>
<span class="n">opt_ts</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_arr3</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Warm</span> <span class="n">starting</span><span class="o">...</span>
<span class="n">Done</span> <span class="k">with</span> <span class="n">warm</span> <span class="n">start</span> <span class="n">after</span> <span class="mf">0.05</span><span class="n">secs</span>

<span class="n">Obj</span> <span class="n">val</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.51774178</span><span class="p">]</span>

<span class="n">Total</span> <span class="n">time</span> <span class="ow">is</span> <span class="mf">14.4</span><span class="n">secs</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># checking model&#39;s size</span>
<span class="n">opt_ts</span><span class="o">.</span><span class="n">get_model_size</span><span class="p">(</span><span class="n">X_arr3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1204</span><span class="p">,</span> <span class="mi">1191</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;total number of cluster changes is: </span><span class="si">{</span><span class="n">opt_ts</span><span class="o">.</span><span class="n">n_changes_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">opt_ts</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()</span> <span class="c1"># indexes of dynamic entities and their number of cluster changes</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">cluster</span> <span class="n">changes</span> <span class="ow">is</span><span class="p">:</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># retrieve the cluster centers and labels</span>
<span class="n">cc_opt_ts</span> <span class="o">=</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">cluster_centers_</span>
<span class="n">labels_opt_ts</span> <span class="o">=</span> <span class="n">opt_ts</span><span class="o">.</span><span class="n">labels_</span>

<span class="c1"># labels of dynamic entities</span>
<span class="n">labels_opt_ts</span><span class="p">[</span><span class="n">opt_ts</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot of model results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X_arr3</span><span class="p">,</span>
    <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cc_opt_ts</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels_opt_ts</span><span class="p">,</span>
    <span class="n">entity_idx</span><span class="o">=</span><span class="n">opt_ts</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">show_all_entities</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_161_0.png" src="../../../_images/tscluster_tutorial_161_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># scoring the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inertia score is </span><span class="si">{</span><span class="n">inertia</span><span class="p">(</span><span class="n">X_arr3</span><span class="p">,</span><span class="w"> </span><span class="n">cc_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="n">labels_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_dist score is </span><span class="si">{</span><span class="n">max_dist</span><span class="p">(</span><span class="n">X_arr3</span><span class="p">,</span><span class="w"> </span><span class="n">cc_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="n">labels_opt_ts</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">140.53425058177024</span>
<span class="n">max_dist</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">1.5177417770731711</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># checking the default label_dict (since we did not set the label dict or pass any during fit)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">opt_ts</span><span class="o">.</span><span class="n">label_dict_</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
</pre></div>
</div>
</section>
</section>
<section id="tsglobalkmeans">
<h3>TSGlobalKmeans<a class="headerlink" href="#tsglobalkmeans" title="Link to this heading">ÔÉÅ</a></h3>
<p>This module applies sklearn‚Äôs k-mean clustering to the data resulting
from concatenating along the time axis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize the model</span>
<span class="n">g_ts_km</span> <span class="o">=</span> <span class="n">TSGlobalKmeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit the model</span>
<span class="n">g_ts_km</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_arr3</span><span class="p">);</span>
</pre></div>
</div>
<pre class="literal-block">/usr/local/lib/python3.10/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of <cite>n_init</cite> will change from 10 to 'auto' in 1.4. Set the value of <cite>n_init</cite> explicitly to suppress the warning
  warnings.warn(</pre>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;total number of cluster changes is: </span><span class="si">{</span><span class="n">g_ts_km</span><span class="o">.</span><span class="n">n_changes_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">g_ts_km</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()</span> <span class="c1"># indexes of dynamic entities and their number of cluster changes</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">cluster</span> <span class="n">changes</span> <span class="ow">is</span><span class="p">:</span> <span class="mi">53</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># retrieve the cluster centers and labels</span>
<span class="n">cc_g_ts_km</span> <span class="o">=</span> <span class="n">g_ts_km</span><span class="o">.</span><span class="n">cluster_centers_</span>
<span class="n">labels_g_ts_km</span> <span class="o">=</span> <span class="n">g_ts_km</span><span class="o">.</span><span class="n">labels_</span>

<span class="c1"># labels of dynamic entities</span>
<span class="n">labels_g_ts_km</span><span class="p">[</span><span class="n">g_ts_km</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot of model results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X_arr3</span><span class="p">,</span>
    <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cc_g_ts_km</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels_g_ts_km</span><span class="p">,</span>
    <span class="n">entity_idx</span><span class="o">=</span><span class="n">g_ts_km</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">show_all_entities</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_170_0.png" src="../../../_images/tscluster_tutorial_170_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># scoring the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inertia score is </span><span class="si">{</span><span class="n">inertia</span><span class="p">(</span><span class="n">X_arr3</span><span class="p">,</span><span class="w"> </span><span class="n">cc_g_ts_km</span><span class="p">,</span><span class="w"> </span><span class="n">labels_g_ts_km</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_dist score is </span><span class="si">{</span><span class="n">max_dist</span><span class="p">(</span><span class="n">X_arr3</span><span class="p">,</span><span class="w"> </span><span class="n">cc_g_ts_km</span><span class="p">,</span><span class="w"> </span><span class="n">labels_g_ts_km</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">166.82397817096967</span>
<span class="n">max_dist</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">3.3717592522248783</span>
</pre></div>
</div>
</section>
<section id="tskmeans">
<h3>TSKmeans<a class="headerlink" href="#tskmeans" title="Link to this heading">ÔÉÅ</a></h3>
<p>This module applies tslearn‚Äôs time series k-mean clustering to the data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize the model</span>
<span class="n">ts_km</span> <span class="o">=</span> <span class="n">TSKmeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit the model</span>
<span class="n">ts_km</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_arr3</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;total number of cluster changes is: </span><span class="si">{</span><span class="n">ts_km</span><span class="o">.</span><span class="n">n_changes_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ts_km</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()</span> <span class="c1"># indexes of dynamic entities and their number of cluster changes</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">cluster</span> <span class="n">changes</span> <span class="ow">is</span><span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">([],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># retrieve the cluster centers and labels</span>
<span class="n">cc_ts_km</span> <span class="o">=</span> <span class="n">ts_km</span><span class="o">.</span><span class="n">cluster_centers_</span>
<span class="n">labels_ts_km</span> <span class="o">=</span> <span class="n">ts_km</span><span class="o">.</span><span class="n">labels_</span>

<span class="c1"># labels of dynamic entities</span>
<span class="n">labels_ts_km</span><span class="p">[</span><span class="n">ts_km</span><span class="o">.</span><span class="n">get_dynamic_entities</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot of model results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tsplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X_arr3</span><span class="p">,</span>
    <span class="n">cluster_centers</span><span class="o">=</span><span class="n">cc_ts_km</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels_ts_km</span>
<span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/tscluster_tutorial_178_0.png" src="../../../_images/tscluster_tutorial_178_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># scoring the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inertia score is </span><span class="si">{</span><span class="n">inertia</span><span class="p">(</span><span class="n">X_arr3</span><span class="p">,</span><span class="w"> </span><span class="n">cc_ts_km</span><span class="p">,</span><span class="w"> </span><span class="n">labels_ts_km</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_dist score is </span><span class="si">{</span><span class="n">max_dist</span><span class="p">(</span><span class="n">X_arr3</span><span class="p">,</span><span class="w"> </span><span class="n">cc_ts_km</span><span class="p">,</span><span class="w"> </span><span class="n">labels_ts_km</span><span class="p">,</span><span class="w"> </span><span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using l1 distance</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">113.52000410204052</span>
<span class="n">max_dist</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">5.437567193350128</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../with_real_world_data/notebook.html" class="btn btn-neutral float-left" title="Tutorial with Real World Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../colab_notebook.html" class="btn btn-neutral float-right" title="Colab Notebook" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, tscluster.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>